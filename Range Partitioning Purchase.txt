Q2. Create a table purchase with attributes p_id, p_name and p_amt using range partitioning
create the following six partitions -
P1- amount less than 1000,
P2- amount less than 2000,
P3- amount less than 3000,
P4- amount less than 4000,
P5- amount less than 5000,
P6- amount less than 10000.

Creating table:
CREATE TABLE PURCHASE
(
P_ID NUMBER,
P_NAME VARCHAR(25),
P_AMT NUMBER
)
PARTITION BY RANGE(P_AMT)
(
PARTITION P1 VALUES LESS THAN(1000),
PARTITION P2 VALUES LESS THAN(2000),
PARTITION P3 VALUES LESS THAN(3000),
PARTITION P4 VALUES LESS THAN(4000),
PARTITION P5 VALUES LESS THAN(5000),
PARTITION P6 VALUES LESS THAN(10000)
);

INSERT INTO PURCHASE VALUES(1,'BAG',2000);
INSERT INTO PURCHASE VALUES(2,'BOOKS',3000);
INSERT INTO PURCHASE VALUES(3,'EARPHONES',1000);
INSERT INTO PURCHASE VALUES(4,'WATCH',4000);
INSERT INTO PURCHASE VALUES(5,'LIGHT',3500);
INSERT INTO PURCHASE VALUES(6,'TELEVISION',2700);
INSERT INTO PURCHASE VALUES(7,'FRIDGE',9999);
INSERT INTO PURCHASE VALUES(8,’SPEAKERS’ ,9800);

1. Display the purchase details having the maximum purchase amount in partition p3.
SELECT * FROM PURCHASE PARTITION(P3) WHERE P_AMT=(SELECT MAX(P_AMT) FROM PURCHASE PARTITION(P3) );

2. Split the partition p1 into pp1 and pp2 with the amount less than 500 and pp2 greater than 500 to pp2.
ALTER TABLE PURCHASE SPLIT PARTITION P1 AT(500)INTO (PARTITION PP1,PARTITION PP2);

3. Merge the partition pp1 and pp2 into a new partition.
ALTER TABLE PURCHASE MERGE PARTITIONS PP1,PP2 INTO PARTITION NEW_P1;